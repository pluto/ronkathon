# BLS Signatures Module

## Overview

The BLS (Boneh-Lynn-Shacham) signatures module provides an implementation of the BLS digital signature scheme, which is based on pairing-based cryptography. BLS signatures are known for their short signature lengths and the ability to aggregate multiple signatures into a single compact signature, making them particularly useful in blockchain and distributed systems.

## Key Features

- **Short Signatures**: BLS signatures are significantly shorter than traditional signatures, which reduces storage and transmission costs.
- **Signature Aggregation**: Multiple signatures can be combined into a single signature, allowing for efficient verification and reduced on-chain data.
- **Security**: BLS signatures provide strong security guarantees based on the hardness of the computational Diffie-Hellman problem in pairing-friendly groups.

## How BLS Signatures Work

### Key Generation

1. **Private Key**: A random value is selected as the private key.
2. **Public Key**: The public key is derived from the private key using a generator point in the elliptic curve.

### Signing

To sign a message, the following steps are performed:

1. **Hashing**: The message is hashed to produce a fixed-size output.
2. **Signature Generation**: The signature is generated by multiplying the hashed message with the private key.

### Verification

To verify a signature, the following steps are performed:

1. **Hashing**: The original message is hashed to produce a fixed-size output.
2. **Signature Verification**: The signature is verified by checking the pairing of the public key, the hashed message, and the signature.

## Signature Aggregation

Multiple signatures can be aggregated into a single signature, which can then be verified against the combined public keys. This is particularly useful in scenarios where multiple parties sign the same message.

### Basic Principle
Given multiple (message, signature) pairs from different signers:
- ($m_1$, $\sigma_1$) from signer 1
- ($m_2$, $\sigma_2$) from signer 2
- ...
- ($m_n$, $\sigma_n$) from signer $n$

We can combine them into a single aggregate signature: $\sigma\_\textrm{agg}= \sigma_1 + \sigma_2 + \cdots + \sigma_n$

### Properties
1. **Size Efficiency**: The aggregate signature has the same size as a single signature
2. **Verification Efficiency**: Verifying the aggregate signature is faster than verifying n signatures individually
3. **Non-interactivity**: Signers don't need to coordinate or communicate
4. **Public Key Aggregation**: Public keys can also be aggregated

### Mathematical Background

BLS signatures work on special elliptic curves with bilinear pairings. The key components are:

1. **Groups**: Uses two groups $G_1$ and $G_2$ with a bilinear mapping $e: G_1 \times G_2 \to G_t$
2. **Hash-to-Curve**: Messages are mapped to curve points using a special hash function
3. **Pairing Check**: Verification uses the bilinear pairing property: $e(g,h)^{ab} = e(g^a,h) = e(g,h^b)$


### Verification Efficiency Deep Dive

When verifying n individual signatures, we need to compute 2n pairings:
- For each signature i: $e(\sigma_i, g) = e(H(m_i), pk_i)$
- This requires 2 pairings per verification
- Total cost: 2n pairing operations

With signature aggregation:
1. For same-message aggregation:
   - $e(\sigma\_\textrm{agg}, g) = e(H(m), pk_\textrm{agg})$
   - Only 2 pairings total, regardless of n.
   
2. For distinct-message aggregation:
   - $e(\sigma\_\textrm{agg}, g) = \prod_{i=1}^{n} e(H(m_i), pk_i)$
   - Requires n+1 pairings
   - Still faster than 2n pairings for individual verification

Since pairing operations are the most computationally expensive part of verification , this optimization is significant:

- Individual verification: O(n) pairings
- Aggregated verification (same message): O(1) pairings
- Aggregated verification (different messages): O(n) pairings but with better constants

This makes BLS particularly efficient for scenarios like blockchain consensus where 
many parties sign the same message.

## References

- [BLS Signature Scheme Paper](https://www.iacr.org/archive/asiacrypt2001/22480516.pdf)
- [BLS Signature Specification](https://tools.ietf.org/html/draft-irtf-cfrg-bls-signature)
- [BLS12-381 For The Rest Of Us](https://hackmd.io/@benjaminion/bls12-381) 